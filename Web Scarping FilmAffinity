from requests import get
import pandas as pd
import numpy as np
from bs4 import BeautifulSoup


df_fa = pd.DataFrame(columns = ('Genero', 'Nombre Pelicula', 'Año estreno', 
                          'País', 'Valoración FA', 'Director', 'Cantidad Votaciones', 'Reparto'))

url = 'https://www.filmaffinity.com/es/topgen.php?genre=BE&fromyear=&toyear=&country=&nodoc'
url1 = 'https://www.filmaffinity.com/es/topgen.php?genre=CO&fromyear=&toyear=&country=&nodoc'
url2 = 'https://www.filmaffinity.com/es/topgen.php?genre=TE&fromyear=&toyear=&country=&nodoc'
url3 = 'https://www.filmaffinity.com/es/topgen.php?genre=DR&fromyear=&toyear=&country=&nodoc'
url4 = 'https://www.filmaffinity.com/es/topgen.php?genre=WE&fromyear=&toyear=&country=&nodoc'


urls = np.array([url, url1, url2, url3, url4])

generos = np.array(['Belico', 'Comedia', 'Terror', 'Drama', 'Western'])


for j in range(0,5):
    response = get(urls[j])
    html_soup = BeautifulSoup(response.text, 'html.parser')

    movie_containers = html_soup.find_all("div", {"class": "mc-info-container"})
    movie_containers_scores = html_soup.find_all("div", {"class": "avg-rating"})
    movie_containers_scores_amount = html_soup.find_all("div", {"class": "rat-count"})
    

    genero = []
    name = []
    year = []
    country = []
    fa_rating = []
    director = []
    votaciones = []
    casting = []


    for i in range(0,30):
        
        genero.append(generos[j])
        
        movie = movie_containers[i]
        nombre = movie.a.text
        name.append(nombre)
    
        año = movie.find('div', class_ = 'mc-title')
        año2 = año.text[-8:-4]
        year.append(año2)

        pais = año.img['alt']
        country.append(pais)
    
        score = movie_containers_scores[i]
        score = score.text    
        fa_rating.append(score)
    
        director1 = movie.find_all("div", {"class": "mc-director"})
        director2 = director1[0].text
        director.append(director2)
    
        votos = movie_containers_scores_amount[i]
        votos1 = votos.text 
        votaciones.append(votos1)
    
        cast = html_soup.find_all("div", {"class": "mc-cast"})
        cast = cast[0].text
        casting.append(cast)
    
    
    df_fa2 = pd.DataFrame({
    'Genero': genero,
    'Nombre Pelicula': name,
    'Año estreno': year,
    'País': country,
    'Valoración FA': fa_rating,
    'Director' : director,
    'Cantidad Votaciones': votaciones,     
    'Reparto': casting})

    df_fa = pd.concat([df_fa, df_fa2], ignore_index = True)
    
    
print(df_fa.info())
df_fa
